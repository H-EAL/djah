namespace djah { namespace math {

	//----------------------------------------------------------------------------------------------
	template<typename T>
	transform<T>::transform
	(
		const vector<3,T> &tr = vector<3,T>::null_vector,
		const quaternion<T> &rot = quaternion<T>::identity,
		const vector<3,T> &s = vector<3,T>(T(1),T(1),T(1))
	)
	: scale_(s)
	, translation_(tr)
	, rotation_(rot)
	{
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline const vector<3,T>& transform<T>::scale() const
	{
		return scale_;
	}
	//----------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline const vector<3,T>& transform<T>::translation() const
	{
		return translation_;
	}
	//----------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline const quaternion<T>& transform<T>::rotation() const
	{
		return rotation_;
	}
	//----------------------------------------------------------------------------------------------

		
	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline void transform<T>::setScale(const vector<3,T> &s)
	{
		scale_ = s;
	}
	//----------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline void transform<T>::setScale(T s)
	{
		scale_.x = s;
		scale_.y = s;
		scale_.z = s;
	}
	//----------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline void transform<T>::setTranslation(const vector<3,T> &tr)
	{
		translation_ = tr;
	}
	//----------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline void transform<T>::setRotation(const quaternion<T> &rot)
	{
		rotation_ = rot;
	}
	//----------------------------------------------------------------------------------------------

	
	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline void transform<T>::uniformScale(T s)
	{
		scale_ *= s;
	}
	//----------------------------------------------------------------------------------------------

	
	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline void transform<T>::scale(const vector<3,T> &s)
	{
		scale_.x *= s.x;
		scale_.y *= s.y;
		scale_.z *= s.z;
	}
	//----------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline void transform<T>::translate(const vector<3,T> &tr)
	{
		translation_ += tr;
	}
	//----------------------------------------------------------------------------------------------

	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline void transform<T>::rotate(const quaternion<T> &rot)
	{
		rotation_ = rotation_ * rot;
	}
	//----------------------------------------------------------------------------------------------

		
	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline transform<T>& transform<T>::combine(const transform<T> &other)
	{
		scale( other.scale_ );
		translate( other.translation_ );
		rotate( other.rotation_ );
	}
	//----------------------------------------------------------------------------------------------

		
	//----------------------------------------------------------------------------------------------
	template<typename T>
	inline const matrix<4,4,T> transform<T>::toMatrix4() const
	{
		return quat_to_matrix4(rotation_) * make_scale(scale_) * make_translation(translation_);
	}
	//----------------------------------------------------------------------------------------------

} /*math*/ } /*djah*/