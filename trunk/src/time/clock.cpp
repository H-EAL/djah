#include "time/clock.hpp"
#include <ctime>

namespace djah { namespace time {

	//----------------------------------------------------------------------------------------------
	clock::clock(bool startNow)
		: startTime_(startNow ? getCurrentTime() : 0)
		, pausedTime_(0)
		, deadTime_(0)
		, paused_(true)
	{

	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	void clock::restart()
	{
		startTime_	= getCurrentTime();
		pausedTime_	= 0;
		deadTime_	= 0;
		paused_		= false;
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	void clock::pause()
	{
		if(!paused_)
		{
			pausedTime_ = getCurrentTime();
			paused_		= true;
		}
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	void clock::unpause()
	{
		if(paused_)
		{
			deadTime_  += getCurrentTime() - pausedTime_;
			pausedTime_	= 0;
			paused_		= false;
		}
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	u64 clock::getElapsedTimeMs() const
	{
		return getCurrentTime() - startTime_ - deadTime_;
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	f32 clock::getElapsedTimeSec() const
	{
		return static_cast<f32>(getElapsedTimeMs()) / (f32)CLOCKS_PER_SEC;
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	u64 clock::getCurrentTime() const
	{
		return static_cast<u64>(::clock());
	}
	//----------------------------------------------------------------------------------------------

} /*time*/ } /*djah*/