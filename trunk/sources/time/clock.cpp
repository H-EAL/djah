#include "time/clock.hpp"
#include <ctime>

namespace djah { namespace time {

	//----------------------------------------------------------------------------------------------
	clock::clock(bool startNow)
		: start_time_(startNow ? getCurrentTime() : 0)
		, paused_time_(0)
		, dead_time_(0)
		, paused_(!startNow)
	{

	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	void clock::restart()
	{
		start_time_	= getCurrentTime();
		paused_time_	= 0;
		dead_time_	= 0;
		paused_		= false;
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	void clock::pause()
	{
		if(!paused_)
		{
			paused_time_ = getCurrentTime();
			paused_		= true;
		}
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	void clock::unpause()
	{
		if(paused_)
		{
			dead_time_  += getCurrentTime() - paused_time_;
			paused_time_	= 0;
			paused_		= false;
		}
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	u64 clock::getElapsedTimeMs() const
	{
		return getCurrentTime() - start_time_ - dead_time_;
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	f32 clock::getElapsedTimeSec() const
	{
		return static_cast<f32>(getElapsedTimeMs()) / (f32)CLOCKS_PER_SEC;
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	u64 clock::getCurrentTime() const
	{
		return static_cast<u64>(::clock());
	}
	//----------------------------------------------------------------------------------------------

} /*time*/ } /*djah*/