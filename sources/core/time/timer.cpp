#include "djah/core/time/timer.hpp"
#include "djah/system/clock.hpp"

namespace djah { namespace time {

	//----------------------------------------------------------------------------------------------
	timer::timer(bool startNow)
		: start_time_(startNow ? getCurrentTime() : 0.0f)
		, paused_time_(0.0f)
		, dead_time_(0.0f)
		, paused_(!startNow)
	{

	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	void timer::restart()
	{
		start_time_	 = getCurrentTime();
		paused_time_ = 0.0f;
		dead_time_	 = 0.0f;
		paused_		 = false;
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	void timer::pause()
	{
		if(!paused_)
		{
			paused_time_ = getCurrentTime();
			paused_		 = true;
		}
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	void timer::unpause()
	{
		if(paused_)
		{
			dead_time_  += getCurrentTime() - paused_time_;
			paused_time_ = 0.0f;
			paused_		 = false;
		}
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	f32 timer::getElapsedTimeMs() const
	{
		return getCurrentTime() - start_time_ - dead_time_;
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	f32 timer::getElapsedTimeSec() const
	{
		return getElapsedTimeMs() / 1000.0f;
	}
	//----------------------------------------------------------------------------------------------


	//----------------------------------------------------------------------------------------------
	f32 timer::getCurrentTime() const
	{
		return system::clock::getCurrentTimeInMs<f32>();
	}
	//----------------------------------------------------------------------------------------------

} /*time*/ } /*djah*/